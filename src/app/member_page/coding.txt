Next.jsì™€ TypeScriptë¥¼ ì‚¬ìš©í•œ Supabase Auth ê¸°ë°˜ì˜ ê°„ë‹¨í•œ íšŒì›ê°€ì…/ë¡œê·¸ì¸ ì‹œìŠ¤í…œì„ ë§Œë“¤ì–´ë“œë¦¬ê² ìŠµë‹ˆë‹¤.

// 1. íŒ¨í‚¤ì§€ ì„¤ì¹˜
// npm install @supabase/supabase-js @supabase/auth-helpers-nextjs @supabase/auth-helpers-react @supabase/auth-ui-react @supabase/auth-ui-shared

// 2. í™˜ê²½ë³€ìˆ˜ ì„¤ì • (.env.local)
/*
NEXT_PUBLIC_SUPABASE_URL=your_supabase_url
NEXT_PUBLIC_SUPABASE_ANON_KEY=your_supabase_anon_key
*/

// 3. Supabase í´ë¼ì´ì–¸íŠ¸ ì„¤ì • (lib/supabase.ts)
import { createClientComponentClient, createServerComponentClient } from '@supabase/auth-helpers-nextjs'
import { cookies } from 'next/headers'

export const createClient = () => {
  return createClientComponentClient()
}

export const createServerClient = () => {
  return createServerComponentClient({ cookies })
}

// 4. íƒ€ì… ì •ì˜ (types/auth.ts)
export interface User {
  id: string
  email: string
  created_at: string
}

export interface AuthState {
  user: User | null
  loading: boolean
}

// 5. Auth Context (contexts/AuthContext.tsx)
'use client'

import { createContext, useContext, useEffect, useState } from 'react'
import { User } from '@supabase/auth-helpers-nextjs'
import { createClient } from '@/lib/supabase'

interface AuthContextType {
  user: User | null
  loading: boolean
  signUp: (email: string, password: string) => Promise<any>
  signIn: (email: string, password: string) => Promise<any>
  signOut: () => Promise<void>
}

const AuthContext = createContext<AuthContextType | undefined>(undefined)

export function AuthProvider({ children }: { children: React.ReactNode }) {
  const [user, setUser] = useState<User | null>(null)
  const [loading, setLoading] = useState(true)
  const supabase = createClient()

  useEffect(() => {
    // í˜„ì¬ ì„¸ì…˜ ê°€ì ¸ì˜¤ê¸°
    const getSession = async () => {
      const { data: { session } } = await supabase.auth.getSession()
      setUser(session?.user ?? null)
      setLoading(false)
    }

    getSession()

    // ì¸ì¦ ìƒíƒœ ë³€ê²½ ë¦¬ìŠ¤ë„ˆ
    const { data: { subscription } } = supabase.auth.onAuthStateChange(
      async (event, session) => {
        setUser(session?.user ?? null)
        setLoading(false)
      }
    )

    return () => subscription.unsubscribe()
  }, [supabase])

  const signUp = async (email: string, password: string) => {
    const { data, error } = await supabase.auth.signUp({
      email,
      password,
      options: {
        emailRedirectTo: `${location.origin}/auth/callback`
      }
    })
    return { data, error }
  }

  const signIn = async (email: string, password: string) => {
    const { data, error } = await supabase.auth.signInWithPassword({
      email,
      password
    })
    return { data, error }
  }

  const signOut = async () => {
    await supabase.auth.signOut()
  }

  return (
    <AuthContext.Provider value={{
      user,
      loading,
      signUp,
      signIn,
      signOut
    }}>
      {children}
    </AuthContext.Provider>
  )
}

export const useAuth = () => {
  const context = useContext(AuthContext)
  if (context === undefined) {
    throw new Error('useAuth must be used within an AuthProvider')
  }
  return context
}

// 6. íšŒì›ê°€ì… ì»´í¬ë„ŒíŠ¸ (components/SignUp.tsx)
'use client'

import { useState } from 'react'
import { useAuth } from '@/contexts/AuthContext'
import { useRouter } from 'next/navigation'

export default function SignUp() {
  const [email, setEmail] = useState('')
  const [password, setPassword] = useState('')
  const [confirmPassword, setConfirmPassword] = useState('')
  const [loading, setLoading] = useState(false)
  const [message, setMessage] = useState('')
  const [error, setError] = useState('')
  
  const { signUp } = useAuth()
  const router = useRouter()

  const handleSignUp = async (e: React.FormEvent) => {
    e.preventDefault()
    
    if (password !== confirmPassword) {
      setError('ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.')
      return
    }

    if (password.length < 6) {
      setError('ë¹„ë°€ë²ˆí˜¸ëŠ” ìµœì†Œ 6ì ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.')
      return
    }

    setLoading(true)
    setError('')
    setMessage('')

    try {
      const { data, error } = await signUp(email, password)
      
      if (error) {
        setError(error.message)
      } else {
        setMessage('íšŒì›ê°€ì…ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤! ì´ë©”ì¼ì„ í™•ì¸í•˜ì—¬ ê³„ì •ì„ ì¸ì¦í•´ì£¼ì„¸ìš”.')
        setEmail('')
        setPassword('')
        setConfirmPassword('')
      }
    } catch (err) {
      setError('íšŒì›ê°€ì… ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.')
    } finally {
      setLoading(false)
    }
  }

  return (
    <div className="max-w-md mx-auto mt-8 p-6 bg-white rounded-lg shadow-md">
      <h2 className="text-2xl font-bold mb-6 text-center">íšŒì›ê°€ì…</h2>
      
      <form onSubmit={handleSignUp} className="space-y-4">
        <div>
          <label htmlFor="email" className="block text-sm font-medium text-gray-700 mb-1">
            ì´ë©”ì¼
          </label>
          <input
            type="email"
            id="email"
            value={email}
            onChange={(e) => setEmail(e.target.value)}
            className="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
            required
          />
        </div>

        <div>
          <label htmlFor="password" className="block text-sm font-medium text-gray-700 mb-1">
            ë¹„ë°€ë²ˆí˜¸
          </label>
          <input
            type="password"
            id="password"
            value={password}
            onChange={(e) => setPassword(e.target.value)}
            className="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
            required
            minLength={6}
          />
        </div>

        <div>
          <label htmlFor="confirmPassword" className="block text-sm font-medium text-gray-700 mb-1">
            ë¹„ë°€ë²ˆí˜¸ í™•ì¸
          </label>
          <input
            type="password"
            id="confirmPassword"
            value={confirmPassword}
            onChange={(e) => setConfirmPassword(e.target.value)}
            className="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
            required
            minLength={6}
          />
        </div>

        {error && (
          <div className="text-red-600 text-sm bg-red-50 p-3 rounded-md">
            {error}
          </div>
        )}

        {message && (
          <div className="text-green-600 text-sm bg-green-50 p-3 rounded-md">
            {message}
          </div>
        )}

        <button
          type="submit"
          disabled={loading}
          className="w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50"
        >
          {loading ? 'ê°€ì… ì¤‘...' : 'íšŒì›ê°€ì…'}
        </button>
      </form>

      <div className="mt-4 text-center">
        <p className="text-sm text-gray-600">
          ì´ë¯¸ ê³„ì •ì´ ìˆìœ¼ì‹ ê°€ìš”?{' '}
          <button
            onClick={() => router.push('/login')}
            className="text-blue-600 hover:text-blue-800"
          >
            ë¡œê·¸ì¸
          </button>
        </p>
      </div>
    </div>
  )
}

// 8. ì¸ì¦ ì½œë°± í˜ì´ì§€ (app/auth/callback/route.ts)
import { createRouteHandlerClient } from '@supabase/auth-helpers-nextjs'
import { cookies } from 'next/headers'
import { NextResponse } from 'next/server'

export async function GET(request: Request) {
  const requestUrl = new URL(request.url)
  const code = requestUrl.searchParams.get('code')

  if (code) {
    const supabase = createRouteHandlerClient({ cookies })
    await supabase.auth.exchangeCodeForSession(code)
  }

  // URLì„ /dashboardë¡œ ë¦¬ë””ë ‰ì…˜í•˜ê±°ë‚˜ ì›í•˜ëŠ” í˜ì´ì§€ë¡œ ë³€ê²½
  return NextResponse.redirect(`${requestUrl.origin}/dashboard`)
}

// 9. ë³´í˜¸ëœ í˜ì´ì§€ ì»´í¬ë„ŒíŠ¸ (components/ProtectedRoute.tsx)
'use client'

import { useAuth } from '@/contexts/AuthContext'
import { useRouter } from 'next/navigation'
import { useEffect } from 'react'

interface ProtectedRouteProps {
  children: React.ReactNode
}

export default function ProtectedRoute({ children }: ProtectedRouteProps) {
  const { user, loading } = useAuth()
  const router = useRouter()

  useEffect(() => {
    if (!loading && !user) {
      router.push('/login')
    }
  }, [user, loading, router])

  if (loading) {
    return (
      <div className="flex items-center justify-center min-h-screen">
        <div className="animate-spin rounded-full h-32 w-32 border-b-2 border-gray-900"></div>
      </div>
    )
  }

  if (!user) {
    return null
  }

  return <>{children}</>
}

// 10. ëŒ€ì‹œë³´ë“œ í˜ì´ì§€ (app/dashboard/page.tsx)
'use client'

import { useAuth } from '@/contexts/AuthContext'
import { useRouter } from 'next/navigation'
import ProtectedRoute from '@/components/ProtectedRoute'

export default function Dashboard() {
  const { user, signOut } = useAuth()
  const router = useRouter()

  const handleSignOut = async () => {
    await signOut()
    router.push('/')
  }

  return (
    <ProtectedRoute>
      <div className="max-w-4xl mx-auto mt-8 p-6">
        <div className="bg-white rounded-lg shadow-md p-6">
          <div className="flex justify-between items-center mb-6">
            <h1 className="text-3xl font-bold">ëŒ€ì‹œë³´ë“œ</h1>
            <button
              onClick={handleSignOut}
              className="bg-red-600 text-white px-4 py-2 rounded-md hover:bg-red-700"
            >
              ë¡œê·¸ì•„ì›ƒ
            </button>
          </div>
          
          <div className="bg-gray-50 p-4 rounded-md">
            <h2 className="text-lg font-semibold mb-2">í™˜ì˜í•©ë‹ˆë‹¤!</h2>
            <p className="text-gray-600">ì´ë©”ì¼: {user?.email}</p>
            <p className="text-gray-600">ì‚¬ìš©ì ID: {user?.id}</p>
          </div>
        </div>
      </div>
    </ProtectedRoute>
  )
}

// 11. ë©”ì¸ ë ˆì´ì•„ì›ƒ (app/layout.tsx)
import type { Metadata } from 'next'
import { AuthProvider } from '@/contexts/AuthContext'
import './globals.css'

export const metadata: Metadata = {
  title: 'Simple Auth App',
  description: 'Next.js with Supabase Authentication',
}

export default function RootLayout({
  children,
}: {
  children: React.ReactNode
}) {
  return (
    <html lang="ko">
      <body>
        <AuthProvider>
          {children}
        </AuthProvider>
      </body>
    </html>
  )
}

// 12. ë©”ì¸ í˜ì´ì§€ (app/page.tsx)
'use client'

import { useAuth } from '@/contexts/AuthContext'
import { useRouter } from 'next/navigation'
import { useEffect } from 'react'

export default function Home() {
  const { user, loading } = useAuth()
  const router = useRouter()

  useEffect(() => {
    if (!loading && user) {
      router.push('/dashboard')
    }
  }, [user, loading, router])

  if (loading) {
    return (
      <div className="flex items-center justify-center min-h-screen">
        <div className="animate-spin rounded-full h-32 w-32 border-b-2 border-gray-900"></div>
      </div>
    )
  }

  return (
    <div className="max-w-4xl mx-auto mt-8 p-6">
      <div className="text-center">
        <h1 className="text-4xl font-bold mb-8">ê°„ë‹¨í•œ ì¸ì¦ ì•±</h1>
        <div className="space-x-4">
          <button
            onClick={() => router.push('/login')}
            className="bg-blue-600 text-white px-6 py-3 rounded-md hover:bg-blue-700"
          >
            ë¡œê·¸ì¸
          </button>
          <button
            onClick={() => router.push('/signup')}
            className="bg-green-600 text-white px-6 py-3 rounded-md hover:bg-green-700"
          >
            íšŒì›ê°€ì…
          </button>
        </div>
      </div>
    </div>
  )
}

// 13. íšŒì›ê°€ì… í˜ì´ì§€ (app/signup/page.tsx)
import SignUp from '@/components/SignUp'

export default function SignUpPage() {
  return <SignUp />
}

import SignIn from '@/components/SignIn'

export default function LoginPage() {
  return <SignIn />
}

// 15. Tailwind CSS ì„¤ì • (tailwind.config.js)
/** @type {import('tailwindcss').Config} */
module.exports = {
  content: [
    './pages/**/*.{js,ts,jsx,tsx,mdx}',
    './components/**/*.{js,ts,jsx,tsx,mdx}',
    './app/**/*.{js,ts,jsx,tsx,mdx}',
  ],
  theme: {
    extend: {},
  },
  plugins: [],
}

// 16. ê¸€ë¡œë²Œ ìŠ¤íƒ€ì¼ (app/globals.css)
@tailwind base;
@tailwind components;
@tailwind utilities;

body {
  background-color: #f3f4f6;
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
}
'use client'

import { useState } from 'react'
import { useAuth } from '@/contexts/AuthContext'
import { useRouter } from 'next/navigation'

export default function SignIn() {
  const [email, setEmail] = useState('')
  const [password, setPassword] = useState('')
  const [loading, setLoading] = useState(false)
  const [error, setError] = useState('')
  
  const { signIn } = useAuth()
  const router = useRouter()

  const handleSignIn = async (e: React.FormEvent) => {
    e.preventDefault()
    setLoading(true)
    setError('')

    try {
      const { data, error } = await signIn(email, password)
      
      if (error) {
        if (error.message.includes('Email not confirmed')) {
          setError('ì´ë©”ì¼ ì¸ì¦ì´ ì™„ë£Œë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. ì´ë©”ì¼ì„ í™•ì¸í•´ì£¼ì„¸ìš”.')
        } else if (error.message.includes('Invalid login credentials')) {
          setError('ì´ë©”ì¼ ë˜ëŠ” ë¹„ë°€ë²ˆí˜¸ê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.')
        } else {
          setError(error.message)
        }
      } else {
        router.push('/dashboard')
      }
    } catch (err) {
      setError('ë¡œê·¸ì¸ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.')
    } finally {
      setLoading(false)
    }
  }

  return (
    <div className="max-w-md mx-auto mt-8 p-6 bg-white rounded-lg shadow-md">
      <h2 className="text-2xl font-bold mb-6 text-center">ë¡œê·¸ì¸</h2>
      
      <form onSubmit={handleSignIn} className="space-y-4">
        <div>
          <label htmlFor="email" className="block text-sm font-medium text-gray-700 mb-1">
            ì´ë©”ì¼
          </label>
          <input
            type="email"
            id="email"
            value={email}
            onChange={(e) => setEmail(e.target.value)}
            className="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
            required
          />
        </div>

        <div>
          <label htmlFor="password" className="block text-sm font-medium text-gray-700 mb-1">
            ë¹„ë°€ë²ˆí˜¸
          </label>
          <input
            type="password"
            id="password"
            value={password}
            onChange={(e) => setPassword(e.target.value)}
            className="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
            required
          />
        </div>

        {error && (
          <div className="text-red-600 text-sm bg-red-50 p-3 rounded-md">
            {error}
          </div>
        )}

        <button
          type="submit"
          disabled={loading}
          className="w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50"
        >
          {loading ? 'ë¡œê·¸ì¸ ì¤‘...' : 'ë¡œê·¸ì¸'}
        </button>
      </form>

      <div className="mt-4 text-center">
        <p className="text-sm text-gray-600">
          ê³„ì •ì´ ì—†ìœ¼ì‹ ê°€ìš”?{' '}
          <button
            onClick={() => router.push('/signup')}
            className="text-blue-600 hover:text-blue-800"
          >
            íšŒì›ê°€ì…
          </button>
        </p>
      </div>
    </div>
  )
}

Next.js TypeScript + Supabase Authë¥¼ ì‚¬ìš©í•œ ê°„ë‹¨í•œ íšŒì›ê°€ì…/ë¡œê·¸ì¸ ì‹œìŠ¤í…œì´ ì™„ì„±ë˜ì—ˆìŠµë‹ˆë‹¤. ì£¼ìš” íŠ¹ì§•ì€:

## ğŸ”§ **ì„¤ì¹˜ ë° ì„¤ì •**

1. **íŒ¨í‚¤ì§€ ì„¤ì¹˜:**
```bash
npm install @supabase/supabase-js @supabase/auth-helpers-nextjs @supabase/auth-helpers-react tailwindcss
```

2. **í™˜ê²½ë³€ìˆ˜ ì„¤ì •** (`.env.local`):
```
NEXT_PUBLIC_SUPABASE_URL=your_supabase_url  
NEXT_PUBLIC_SUPABASE_ANON_KEY=your_supabase_anon_key
```

## âœ¨ **ì£¼ìš” ê¸°ëŠ¥**

- **ê°„ë‹¨í•œ íšŒì›ê°€ì…**: ì´ë©”ì¼ + ë¹„ë°€ë²ˆí˜¸ë§Œ ìˆ˜ì§‘
- **ì´ë©”ì¼ ì¸ì¦**: íšŒì›ê°€ì… í›„ ì´ë©”ì¼ í™•ì¸ í•„ìš”
- **ë¡œê·¸ì¸/ë¡œê·¸ì•„ì›ƒ**: ê¸°ë³¸ì ì¸ ì¸ì¦ íë¦„
- **ë³´í˜¸ëœ ë¼ìš°íŠ¸**: ë¡œê·¸ì¸ëœ ì‚¬ìš©ìë§Œ ì ‘ê·¼ ê°€ëŠ¥
- **TypeScript ì§€ì›**: íƒ€ì… ì•ˆì „ì„± ë³´ì¥

## ğŸ“ **í´ë” êµ¬ì¡°**

```
app/
â”œâ”€â”€ layout.tsx
â”œâ”€â”€ page.tsx
â”œâ”€â”€ login/page.tsx
â”œâ”€â”€ signup/page.tsx  
â”œâ”€â”€ dashboard/page.tsx
â”œâ”€â”€ auth/callback/route.ts
â””â”€â”€ globals.css

components/
â”œâ”€â”€ SignUp.tsx
â”œâ”€â”€ SignIn.tsx
â””â”€â”€ ProtectedRoute.tsx

contexts/
â””â”€â”€ AuthContext.tsx

lib/
â””â”€â”€ supabase.ts

types/
â””â”€â”€ auth.ts
```

## ğŸš€ **ì‚¬ìš© ë°©ë²•**

1. Supabase í”„ë¡œì íŠ¸ ìƒì„± ë° í™˜ê²½ë³€ìˆ˜ ì„¤ì •
2. ì´ë©”ì¼ í…œí”Œë¦¿ì—ì„œ ë¦¬ë””ë ‰ì…˜ URLì„ `your-domain.com/auth/callback`ë¡œ ì„¤ì •
3. `npm run dev`ë¡œ ê°œë°œ ì„œë²„ ì‹¤í–‰

ì´ ì‹œìŠ¤í…œì€ ìš”êµ¬ì‚¬í•­ì— ë§ê²Œ ì†Œì…œ ë¡œê·¸ì¸, ê´€ë¦¬ì êµ¬ë¶„, ì¶”ê°€ ì •ë³´ ìˆ˜ì§‘, ë°±í…ŒìŠ¤íŒ… ì €ì¥ ê¸°ëŠ¥ì„ ëª¨ë‘ ì œì™¸í•˜ê³  ìµœì†Œí•œì˜ ì¸ì¦ ê¸°ëŠ¥ë§Œ í¬í•¨í–ˆìŠµë‹ˆë‹¤.

// 1. íŒ¨í‚¤ì§€ ì„¤ì¹˜
// npm install @supabase/supabase-js @supabase/auth-helpers-nextjs @supabase/auth-helpers-react @supabase/auth-ui-react @supabase/auth-ui-shared

// 2. í™˜ê²½ë³€ìˆ˜ ì„¤ì • (.env.local)
/*
NEXT_PUBLIC_SUPABASE_URL=your_supabase_url
NEXT_PUBLIC_SUPABASE_ANON_KEY=your_supabase_anon_key
*/

// 3. Supabase í´ë¼ì´ì–¸íŠ¸ ì„¤ì • (lib/supabase.ts)
import { createClientComponentClient, createServerComponentClient } from '@supabase/auth-helpers-nextjs'
import { cookies } from 'next/headers'

export const createClient = () => {
  return createClientComponentClient()
}

export const createServerClient = () => {
  return createServerComponentClient({ cookies })
}

// 4. íƒ€ì… ì •ì˜ (types/auth.ts)
export interface User {
  id: string
  email: string
  created_at: string
}

export interface AuthState {
  user: User | null
  loading: boolean
}

// 5. Auth Context (contexts/AuthContext.tsx)
'use client'

import { createContext, useContext, useEffect, useState } from 'react'
import { User } from '@supabase/auth-helpers-nextjs'
import { createClient } from '@/lib/supabase'

interface AuthContextType {
  user: User | null
  loading: boolean
  signUp: (email: string, password: string) => Promise<any>
  signIn: (email: string, password: string) => Promise<any>
  signOut: () => Promise<void>
}

const AuthContext = createContext<AuthContextType | undefined>(undefined)

export function AuthProvider({ children }: { children: React.ReactNode }) {
  const [user, setUser] = useState<User | null>(null)
  const [loading, setLoading] = useState(true)
  const supabase = createClient()

  useEffect(() => {
    // í˜„ì¬ ì„¸ì…˜ ê°€ì ¸ì˜¤ê¸°
    const getSession = async () => {
      const { data: { session } } = await supabase.auth.getSession()
      setUser(session?.user ?? null)
      setLoading(false)
    }

    getSession()

    // ì¸ì¦ ìƒíƒœ ë³€ê²½ ë¦¬ìŠ¤ë„ˆ
    const { data: { subscription } } = supabase.auth.onAuthStateChange(
      async (event, session) => {
        setUser(session?.user ?? null)
        setLoading(false)
      }
    )

    return () => subscription.unsubscribe()
  }, [supabase])

  const signUp = async (email: string, password: string) => {
    const { data, error } = await supabase.auth.signUp({
      email,
      password,
      options: {
        emailRedirectTo: `${location.origin}/auth/callback`
      }
    })
    return { data, error }
  }

  const signIn = async (email: string, password: string) => {
    const { data, error } = await supabase.auth.signInWithPassword({
      email,
      password
    })
    return { data, error }
  }

  const signOut = async () => {
    await supabase.auth.signOut()
  }

  return (
    <AuthContext.Provider value={{
      user,
      loading,
      signUp,
      signIn,
      signOut
    }}>
      {children}
    </AuthContext.Provider>
  )
}

export const useAuth = () => {
  const context = useContext(AuthContext)
  if (context === undefined) {
    throw new Error('useAuth must be used within an AuthProvider')
  }
  return context
}

// 6. íšŒì›ê°€ì… ì»´í¬ë„ŒíŠ¸ (components/SignUp.tsx)
'use client'

import { useState } from 'react'
import { useAuth } from '@/contexts/AuthContext'
import { useRouter } from 'next/navigation'

export default function SignUp() {
  const [email, setEmail] = useState('')
  const [password, setPassword] = useState('')
  const [confirmPassword, setConfirmPassword] = useState('')
  const [loading, setLoading] = useState(false)
  const [message, setMessage] = useState('')
  const [error, setError] = useState('')
  
  const { signUp } = useAuth()
  const router = useRouter()

  const handleSignUp = async (e: React.FormEvent) => {
    e.preventDefault()
    
    if (password !== confirmPassword) {
      setError('ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.')
      return
    }

    if (password.length < 6) {
      setError('ë¹„ë°€ë²ˆí˜¸ëŠ” ìµœì†Œ 6ì ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.')
      return
    }

    setLoading(true)
    setError('')
    setMessage('')

    try {
      const { data, error } = await signUp(email, password)
      
      if (error) {
        setError(error.message)
      } else {
        setMessage('íšŒì›ê°€ì…ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤! ì´ë©”ì¼ì„ í™•ì¸í•˜ì—¬ ê³„ì •ì„ ì¸ì¦í•´ì£¼ì„¸ìš”.')
        setEmail('')
        setPassword('')
        setConfirmPassword('')
      }
    } catch (err) {
      setError('íšŒì›ê°€ì… ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.')
    } finally {
      setLoading(false)
    }
  }

  return (
    <div className="max-w-md mx-auto mt-8 p-6 bg-white rounded-lg shadow-md">
      <h2 className="text-2xl font-bold mb-6 text-center">íšŒì›ê°€ì…</h2>
      
      <form onSubmit={handleSignUp} className="space-y-4">
        <div>
          <label htmlFor="email" className="block text-sm font-medium text-gray-700 mb-1">
            ì´ë©”ì¼
          </label>
          <input
            type="email"
            id="email"
            value={email}
            onChange={(e) => setEmail(e.target.value)}
            className="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
            required
          />
        </div>

        <div>
          <label htmlFor="password" className="block text-sm font-medium text-gray-700 mb-1">
            ë¹„ë°€ë²ˆí˜¸
          </label>
          <input
            type="password"
            id="password"
            value={password}
            onChange={(e) => setPassword(e.target.value)}
            className="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
            required
            minLength={6}
          />
        </div>

        <div>
          <label htmlFor="confirmPassword" className="block text-sm font-medium text-gray-700 mb-1">
            ë¹„ë°€ë²ˆí˜¸ í™•ì¸
          </label>
          <input
            type="password"
            id="confirmPassword"
            value={confirmPassword}
            onChange={(e) => setConfirmPassword(e.target.value)}
            className="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
            required
            minLength={6}
          />
        </div>

        {error && (
          <div className="text-red-600 text-sm bg-red-50 p-3 rounded-md">
            {error}
          </div>
        )}

        {message && (
          <div className="text-green-600 text-sm bg-green-50 p-3 rounded-md">
            {message}
          </div>
        )}

        <button
          type="submit"
          disabled={loading}
          className="w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50"
        >
          {loading ? 'ê°€ì… ì¤‘...' : 'íšŒì›ê°€ì…'}
        </button>
      </form>

      <div className="mt-4 text-center">
        <p className="text-sm text-gray-600">
          ì´ë¯¸ ê³„ì •ì´ ìˆìœ¼ì‹ ê°€ìš”?{' '}
          <button
            onClick={() => router.push('/login')}
            className="text-blue-600 hover:text-blue-800"
          >
            ë¡œê·¸ì¸
          </button>
        </p>
      </div>
    </div>
  )
}

// 8. ì¸ì¦ ì½œë°± í˜ì´ì§€ (app/auth/callback/route.ts)
import { createRouteHandlerClient } from '@supabase/auth-helpers-nextjs'
import { cookies } from 'next/headers'
import { NextResponse } from 'next/server'

export async function GET(request: Request) {
  const requestUrl = new URL(request.url)
  const code = requestUrl.searchParams.get('code')

  if (code) {
    const supabase = createRouteHandlerClient({ cookies })
    await supabase.auth.exchangeCodeForSession(code)
  }

  // URLì„ /dashboardë¡œ ë¦¬ë””ë ‰ì…˜í•˜ê±°ë‚˜ ì›í•˜ëŠ” í˜ì´ì§€ë¡œ ë³€ê²½
  return NextResponse.redirect(`${requestUrl.origin}/dashboard`)
}

// 9. ë³´í˜¸ëœ í˜ì´ì§€ ì»´í¬ë„ŒíŠ¸ (components/ProtectedRoute.tsx)
'use client'

import { useAuth } from '@/contexts/AuthContext'
import { useRouter } from 'next/navigation'
import { useEffect } from 'react'

interface ProtectedRouteProps {
  children: React.ReactNode
}

export default function ProtectedRoute({ children }: ProtectedRouteProps) {
  const { user, loading } = useAuth()
  const router = useRouter()

  useEffect(() => {
    if (!loading && !user) {
      router.push('/login')
    }
  }, [user, loading, router])

  if (loading) {
    return (
      <div className="flex items-center justify-center min-h-screen">
        <div className="animate-spin rounded-full h-32 w-32 border-b-2 border-gray-900"></div>
      </div>
    )
  }

  if (!user) {
    return null
  }

  return <>{children}</>
}

// 10. ëŒ€ì‹œë³´ë“œ í˜ì´ì§€ (app/dashboard/page.tsx)
'use client'

import { useAuth } from '@/contexts/AuthContext'
import { useRouter } from 'next/navigation'
import ProtectedRoute from '@/components/ProtectedRoute'

export default function Dashboard() {
  const { user, signOut } = useAuth()
  const router = useRouter()

  const handleSignOut = async () => {
    await signOut()
    router.push('/')
  }

  return (
    <ProtectedRoute>
      <div className="max-w-4xl mx-auto mt-8 p-6">
        <div className="bg-white rounded-lg shadow-md p-6">
          <div className="flex justify-between items-center mb-6">
            <h1 className="text-3xl font-bold">ëŒ€ì‹œë³´ë“œ</h1>
            <button
              onClick={handleSignOut}
              className="bg-red-600 text-white px-4 py-2 rounded-md hover:bg-red-700"
            >
              ë¡œê·¸ì•„ì›ƒ
            </button>
          </div>
          
          <div className="bg-gray-50 p-4 rounded-md">
            <h2 className="text-lg font-semibold mb-2">í™˜ì˜í•©ë‹ˆë‹¤!</h2>
            <p className="text-gray-600">ì´ë©”ì¼: {user?.email}</p>
            <p className="text-gray-600">ì‚¬ìš©ì ID: {user?.id}</p>
          </div>
        </div>
      </div>
    </ProtectedRoute>
  )
}

// 11. ë©”ì¸ ë ˆì´ì•„ì›ƒ (app/layout.tsx)
import type { Metadata } from 'next'
import { AuthProvider } from '@/contexts/AuthContext'
import './globals.css'

export const metadata: Metadata = {
  title: 'Simple Auth App',
  description: 'Next.js with Supabase Authentication',
}

export default function RootLayout({
  children,
}: {
  children: React.ReactNode
}) {
  return (
    <html lang="ko">
      <body>
        <AuthProvider>
          {children}
        </AuthProvider>
      </body>
    </html>
  )
}

// 12. ë©”ì¸ í˜ì´ì§€ (app/page.tsx)
'use client'

import { useAuth } from '@/contexts/AuthContext'
import { useRouter } from 'next/navigation'
import { useEffect } from 'react'

export default function Home() {
  const { user, loading } = useAuth()
  const router = useRouter()

  useEffect(() => {
    if (!loading && user) {
      router.push('/dashboard')
    }
  }, [user, loading, router])

  if (loading) {
    return (
      <div className="flex items-center justify-center min-h-screen">
        <div className="animate-spin rounded-full h-32 w-32 border-b-2 border-gray-900"></div>
      </div>
    )
  }

  return (
    <div className="max-w-4xl mx-auto mt-8 p-6">
      <div className="text-center">
        <h1 className="text-4xl font-bold mb-8">ê°„ë‹¨í•œ ì¸ì¦ ì•±</h1>
        <div className="space-x-4">
          <button
            onClick={() => router.push('/login')}
            className="bg-blue-600 text-white px-6 py-3 rounded-md hover:bg-blue-700"
          >
            ë¡œê·¸ì¸
          </button>
          <button
            onClick={() => router.push('/signup')}
            className="bg-green-600 text-white px-6 py-3 rounded-md hover:bg-green-700"
          >
            íšŒì›ê°€ì…
          </button>
        </div>
      </div>
    </div>
  )
}

// 13. íšŒì›ê°€ì… í˜ì´ì§€ (app/signup/page.tsx)
import SignUp from '@/components/SignUp'

export default function SignUpPage() {
  return <SignUp />
}

import SignIn from '@/components/SignIn'

export default function LoginPage() {
  return <SignIn />
}

// 15. Tailwind CSS ì„¤ì • (tailwind.config.js)
/** @type {import('tailwindcss').Config} */
module.exports = {
  content: [
    './pages/**/*.{js,ts,jsx,tsx,mdx}',
    './components/**/*.{js,ts,jsx,tsx,mdx}',
    './app/**/*.{js,ts,jsx,tsx,mdx}',
  ],
  theme: {
    extend: {},
  },
  plugins: [],
}

// 16. ê¸€ë¡œë²Œ ìŠ¤íƒ€ì¼ (app/globals.css)
@tailwind base;
@tailwind components;
@tailwind utilities;

body {
  background-color: #f3f4f6;
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
}
'use client'

import { useState } from 'react'
import { useAuth } from '@/contexts/AuthContext'
import { useRouter } from 'next/navigation'

export default function SignIn() {
  const [email, setEmail] = useState('')
  const [password, setPassword] = useState('')
  const [loading, setLoading] = useState(false)
  const [error, setError] = useState('')
  
  const { signIn } = useAuth()
  const router = useRouter()

  const handleSignIn = async (e: React.FormEvent) => {
    e.preventDefault()
    setLoading(true)
    setError('')

    try {
      const { data, error } = await signIn(email, password)
      
      if (error) {
        if (error.message.includes('Email not confirmed')) {
          setError('ì´ë©”ì¼ ì¸ì¦ì´ ì™„ë£Œë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. ì´ë©”ì¼ì„ í™•ì¸í•´ì£¼ì„¸ìš”.')
        } else if (error.message.includes('Invalid login credentials')) {
          setError('ì´ë©”ì¼ ë˜ëŠ” ë¹„ë°€ë²ˆí˜¸ê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.')
        } else {
          setError(error.message)
        }
      } else {
        router.push('/dashboard')
      }
    } catch (err) {
      setError('ë¡œê·¸ì¸ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.')
    } finally {
      setLoading(false)
    }
  }

  return (
    <div className="max-w-md mx-auto mt-8 p-6 bg-white rounded-lg shadow-md">
      <h2 className="text-2xl font-bold mb-6 text-center">ë¡œê·¸ì¸</h2>
      
      <form onSubmit={handleSignIn} className="space-y-4">
        <div>
          <label htmlFor="email" className="block text-sm font-medium text-gray-700 mb-1">
            ì´ë©”ì¼
          </label>
          <input
            type="email"
            id="email"
            value={email}
            onChange={(e) => setEmail(e.target.value)}
            className="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
            required
          />
        </div>

        <div>
          <label htmlFor="password" className="block text-sm font-medium text-gray-700 mb-1">
            ë¹„ë°€ë²ˆí˜¸
          </label>
          <input
            type="password"
            id="password"
            value={password}
            onChange={(e) => setPassword(e.target.value)}
            className="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
            required
          />
        </div>

        {error && (
          <div className="text-red-600 text-sm bg-red-50 p-3 rounded-md">
            {error}
          </div>
        )}

        <button
          type="submit"
          disabled={loading}
          className="w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50"
        >
          {loading ? 'ë¡œê·¸ì¸ ì¤‘...' : 'ë¡œê·¸ì¸'}
        </button>
      </form>

      <div className="mt-4 text-center">
        <p className="text-sm text-gray-600">
          ê³„ì •ì´ ì—†ìœ¼ì‹ ê°€ìš”?{' '}
          <button
            onClick={() => router.push('/signup')}
            className="text-blue-600 hover:text-blue-800"
          >
            íšŒì›ê°€ì…
          </button>
        </p>
      </div>
    </div>
  )
}